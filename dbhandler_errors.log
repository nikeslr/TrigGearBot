{"timestamp": "2025-10-31T08:00:31.558487", "level": "ERROR", "trace_id": "3a7fbe32-487a-4fe1-bc5c-760c75fc1467", "event_type": null, "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:00:31.557221', 'DEBUG', 'handle_message', 'ae541416-0ad9-4aca-8624-5d240ed0e62b', 'Поступило сообщение: ewq', '{\"text\": \"ewq\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "chat_id": null, "user_id": null, "payload": {"failed_message": "Поступило сообщение: ewq", "trace_id": "ae541416-0ad9-4aca-8624-5d240ed0e62b", "event_type": "handle_message"}, "logger": "TrigGearBot.DBHandlerError", "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:00:31.557221', 'DEBUG', 'handle_message', 'ae541416-0ad9-4aca-8624-5d240ed0e62b', 'Поступило сообщение: ewq', '{\"text\": \"ewq\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"timestamp": "2025-10-31T08:00:31.580342", "level": "ERROR", "trace_id": "3a7fbe32-487a-4fe1-bc5c-760c75fc1467", "event_type": null, "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:00:31.579323', 'DEBUG', 'handle_message', 'ae541416-0ad9-4aca-8624-5d240ed0e62b', 'Сообщение обработано успешно', '{\"text\": \"ewq\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "chat_id": null, "user_id": null, "payload": {"failed_message": "Сообщение обработано успешно", "trace_id": "ae541416-0ad9-4aca-8624-5d240ed0e62b", "event_type": "handle_message"}, "logger": "TrigGearBot.DBHandlerError", "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:00:31.579323', 'DEBUG', 'handle_message', 'ae541416-0ad9-4aca-8624-5d240ed0e62b', 'Сообщение обработано успешно', '{\"text\": \"ewq\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"timestamp": "2025-10-31T08:01:14.609088", "level": "ERROR", "trace_id": "3a7fbe32-487a-4fe1-bc5c-760c75fc1467", "event_type": null, "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:14.608039', 'DEBUG', 'handle_message', '821116a5-9c2f-44c5-b797-70914f27cd63', 'Поступило сообщение: gr', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "chat_id": null, "user_id": null, "payload": {"failed_message": "Поступило сообщение: gr", "trace_id": "821116a5-9c2f-44c5-b797-70914f27cd63", "event_type": "handle_message"}, "logger": "TrigGearBot.DBHandlerError", "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:14.608039', 'DEBUG', 'handle_message', '821116a5-9c2f-44c5-b797-70914f27cd63', 'Поступило сообщение: gr', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"timestamp": "2025-10-31T08:01:14.628303", "level": "ERROR", "trace_id": "3a7fbe32-487a-4fe1-bc5c-760c75fc1467", "event_type": null, "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:14.627325', 'DEBUG', 'handle_message', '821116a5-9c2f-44c5-b797-70914f27cd63', 'Обнаружено ключевое слово категории test', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\", \"category\": \"test\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "chat_id": null, "user_id": null, "payload": {"failed_message": "Обнаружено ключевое слово категории test", "trace_id": "821116a5-9c2f-44c5-b797-70914f27cd63", "event_type": "handle_message"}, "logger": "TrigGearBot.DBHandlerError", "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:14.627325', 'DEBUG', 'handle_message', '821116a5-9c2f-44c5-b797-70914f27cd63', 'Обнаружено ключевое слово категории test', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\", \"category\": \"test\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{
  "chat_id": null,
  "event_type": null,
  "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:14.644263', 'DEBUG', 'handle_message', '821116a5-9c2f-44c5-b797-70914f27cd63', 'Сообщение обработано успешно', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)",
  "level": "ERROR",
  "logger": "TrigGearBot.DBHandlerError",
  "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:14.644263', 'DEBUG', 'handle_message', '821116a5-9c2f-44c5-b797-70914f27cd63', 'Сообщение обработано успешно', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)",
  "payload": {
    "event_type": "handle_message",
    "failed_message": "Сообщение обработано успешно",
    "trace_id": "821116a5-9c2f-44c5-b797-70914f27cd63"
  },
  "timestamp": "2025-10-31T08:01:14.645666",
  "trace_id": "3a7fbe32-487a-4fe1-bc5c-760c75fc1467",
  "user_id": null
}
{"timestamp": "2025-10-31T08:01:14.653477", "level": "ERROR", "trace_id": "3a7fbe32-487a-4fe1-bc5c-760c75fc1467", "event_type": null, "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:14.652214', 'DEBUG', 'handle_message', '0495243f-dc09-4baf-ad5f-af1181c402b0', 'Поступило сообщение: gr', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "chat_id": null, "user_id": null, "payload": {"failed_message": "Поступило сообщение: gr", "trace_id": "0495243f-dc09-4baf-ad5f-af1181c402b0", "event_type": "handle_message"}, "logger": "TrigGearBot.DBHandlerError", "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:14.652214', 'DEBUG', 'handle_message', '0495243f-dc09-4baf-ad5f-af1181c402b0', 'Поступило сообщение: gr', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"timestamp": "2025-10-31T08:01:14.671607", "level": "ERROR", "trace_id": "3a7fbe32-487a-4fe1-bc5c-760c75fc1467", "event_type": null, "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:14.669501', 'DEBUG', 'handle_message', '0495243f-dc09-4baf-ad5f-af1181c402b0', 'Обнаружено ключевое слово категории test', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\", \"category\": \"test\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "chat_id": null, "user_id": null, "payload": {"failed_message": "Обнаружено ключевое слово категории test", "trace_id": "0495243f-dc09-4baf-ad5f-af1181c402b0", "event_type": "handle_message"}, "logger": "TrigGearBot.DBHandlerError", "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:14.669501', 'DEBUG', 'handle_message', '0495243f-dc09-4baf-ad5f-af1181c402b0', 'Обнаружено ключевое слово категории test', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\", \"category\": \"test\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"timestamp": "2025-10-31T08:01:15.018997", "level": "ERROR", "trace_id": "3a7fbe32-487a-4fe1-bc5c-760c75fc1467", "event_type": null, "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:15.017698', 'DEBUG', 'handle_message', '0495243f-dc09-4baf-ad5f-af1181c402b0', 'Сработал счетчик триггеров категории test', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\", \"category\": \"test\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "chat_id": null, "user_id": null, "payload": {"failed_message": "Сработал счетчик триггеров категории test", "trace_id": "0495243f-dc09-4baf-ad5f-af1181c402b0", "event_type": "handle_message"}, "logger": "TrigGearBot.DBHandlerError", "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:15.017698', 'DEBUG', 'handle_message', '0495243f-dc09-4baf-ad5f-af1181c402b0', 'Сработал счетчик триггеров категории test', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\", \"category\": \"test\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"timestamp": "2025-10-31T08:01:15.031612", "level": "ERROR", "trace_id": "3a7fbe32-487a-4fe1-bc5c-760c75fc1467", "event_type": null, "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:15.030511', 'DEBUG', 'handle_message', '0495243f-dc09-4baf-ad5f-af1181c402b0', 'Сообщение обработано успешно', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "chat_id": null, "user_id": null, "payload": {"failed_message": "Сообщение обработано успешно", "trace_id": "0495243f-dc09-4baf-ad5f-af1181c402b0", "event_type": "handle_message"}, "logger": "TrigGearBot.DBHandlerError", "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:01:15.030511', 'DEBUG', 'handle_message', '0495243f-dc09-4baf-ad5f-af1181c402b0', 'Сообщение обработано успешно', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"timestamp": "2025-10-31T08:31:00.146042", "level": "ERROR", "trace_id": "7a33887f-ca7e-47cb-abce-0174e99cf0c6", "event_type": "handle_message", "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:31:00.138379', 'DEBUG', 'handle_message', '7a33887f-ca7e-47cb-abce-0174e99cf0c6', 'Поступило сообщение: уку', '{\"text\": \"\\\\u0443\\\\u043a\\\\u0443\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "chat_id": -4734439984, "user_id": 377503014, "payload": {"failed_message": "Поступило сообщение: уку", "trace_id": "7a33887f-ca7e-47cb-abce-0174e99cf0c6", "event_type": "handle_message"}, "logger": "TrigGearBot.DBHandlerError", "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:31:00.138379', 'DEBUG', 'handle_message', '7a33887f-ca7e-47cb-abce-0174e99cf0c6', 'Поступило сообщение: уку', '{\"text\": \"\\\\u0443\\\\u043a\\\\u0443\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"timestamp": "2025-10-31T08:31:00.177868", "level": "ERROR", "trace_id": "7a33887f-ca7e-47cb-abce-0174e99cf0c6", "event_type": "handle_message", "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:31:00.176501', 'DEBUG', 'handle_message', '7a33887f-ca7e-47cb-abce-0174e99cf0c6', 'Сообщение обработано успешно', '{\"text\": \"\\\\u0443\\\\u043a\\\\u0443\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "chat_id": -4734439984, "user_id": 377503014, "payload": {"failed_message": "Сообщение обработано успешно", "trace_id": "7a33887f-ca7e-47cb-abce-0174e99cf0c6", "event_type": "handle_message"}, "logger": "TrigGearBot.DBHandlerError", "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:31:00.176501', 'DEBUG', 'handle_message', '7a33887f-ca7e-47cb-abce-0174e99cf0c6', 'Сообщение обработано успешно', '{\"text\": \"\\\\u0443\\\\u043a\\\\u0443\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"timestamp": "2025-10-31T08:31:01.610315", "level": "ERROR", "trace_id": "6916c233-db03-4da6-855e-7e3f9851441c", "event_type": "handle_message", "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:31:01.608944', 'DEBUG', 'handle_message', '6916c233-db03-4da6-855e-7e3f9851441c', 'Поступило сообщение: gr', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "chat_id": -4734439984, "user_id": 377503014, "payload": {"failed_message": "Поступило сообщение: gr", "trace_id": "6916c233-db03-4da6-855e-7e3f9851441c", "event_type": "handle_message"}, "logger": "TrigGearBot.DBHandlerError", "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:31:01.608944', 'DEBUG', 'handle_message', '6916c233-db03-4da6-855e-7e3f9851441c', 'Поступило сообщение: gr', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"timestamp": "2025-10-31T08:31:01.644921", "level": "ERROR", "trace_id": "6916c233-db03-4da6-855e-7e3f9851441c", "event_type": "handle_message", "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:31:01.638614', 'DEBUG', 'handle_message', '6916c233-db03-4da6-855e-7e3f9851441c', 'Обнаружено ключевое слово категории test', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\", \"category\": \"test\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "chat_id": -4734439984, "user_id": 377503014, "payload": {"failed_message": "Обнаружено ключевое слово категории test", "trace_id": "6916c233-db03-4da6-855e-7e3f9851441c", "event_type": "handle_message"}, "logger": "TrigGearBot.DBHandlerError", "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:31:01.638614', 'DEBUG', 'handle_message', '6916c233-db03-4da6-855e-7e3f9851441c', 'Обнаружено ключевое слово категории test', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\", \"category\": \"test\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{
  "chat_id": -4734439984,
  "event_type": "handle_message",
  "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: logs\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:31:01.672170', 'DEBUG', 'handle_message', '6916c233-db03-4da6-855e-7e3f9851441c', 'Сообщение обработано успешно', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)",
  "level": "ERROR",
  "logger": "TrigGearBot.DBHandlerError",
  "message": "Ошибка записи лога в БД: (sqlite3.OperationalError) no such table: logs\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('2025-10-31 08:31:01.672170', 'DEBUG', 'handle_message', '6916c233-db03-4da6-855e-7e3f9851441c', 'Сообщение обработано успешно', '{\"text\": \"gr\", \"username\": \"rainey\", \"chatname\": \"trigGearChat\", \"update_type\": \"message\"}', -4734439984, 377503014)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)",
  "payload": {
    "event_type": "handle_message",
    "failed_message": "Сообщение обработано успешно",
    "trace_id": "6916c233-db03-4da6-855e-7e3f9851441c"
  },
  "timestamp": "2025-10-31T08:31:01.674587",
  "trace_id": "6916c233-db03-4da6-855e-7e3f9851441c",
  "user_id": 377503014
}
{"timestamp": "2025-11-02T20:03:45.335978", "level": "ERROR", "trace_id": "db97da4c-274f-4820-abee-f27acb23c0e2", "event_type": "my_chats", "message": "Ошибка записи лога в БД: (builtins.TypeError) Object of type InlineKeyboardMarkup is not JSON serializable\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: [{'level': 'INFO', 'user_id': 377503014, 'payload': {'text': '/my_chats', 'username': 'rainey', 'chatname': 'rainey', 'update_type': 'message', 'markup ... (189 characters truncated) ... 2', 'message': 'Показан список чатов', 'event_type': 'my_chats', 'chat_id': 377503014, 'timestamp': datetime.datetime(2025, 11, 2, 20, 3, 45, 334571)}]]", "chat_id": 377503014, "user_id": 377503014, "payload": {"failed_message": "Показан список чатов", "trace_id": "db97da4c-274f-4820-abee-f27acb23c0e2", "event_type": "my_chats"}, "logger": "TrigGearBot.DBHandlerError", "exception": "Traceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1812, in _execute_context\n    context = constructor(\n        dialect, self, conn, execution_options, *args, **kw\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 1487, in _init_compiled\n    flattened_processors[key](compiled_params[key])\n    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\sqltypes.py\", line 2779, in process\n    return json_serializer(value)\n  File \"C:\\Program Files\\Python313\\Lib\\json\\__init__.py\", line 231, in dumps\n    return _default_encoder.encode(obj)\n           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^\n  File \"C:\\Program Files\\Python313\\Lib\\json\\encoder.py\", line 200, in encode\n    chunks = self.iterencode(o, _one_shot=True)\n  File \"C:\\Program Files\\Python313\\Lib\\json\\encoder.py\", line 261, in iterencode\n    return _iterencode(o, 0)\n  File \"C:\\Program Files\\Python313\\Lib\\json\\encoder.py\", line 180, in default\n    raise TypeError(f'Object of type {o.__class__.__name__} '\n                    f'is not JSON serializable')\nTypeError: Object of type InlineKeyboardMarkup is not JSON serializable\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\locallog\\logger.py\", line 68, in emit\n    session.commit()\n    ~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1818, in _execute_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str(statement), parameters, None, None\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1812, in _execute_context\n    context = constructor(\n        dialect, self, conn, execution_options, *args, **kw\n    )\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 1487, in _init_compiled\n    flattened_processors[key](compiled_params[key])\n    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^\n  File \"Q:\\DEV\\projects\\TrigGearBot\\pythonProject\\.venv313\\Lib\\site-packages\\sqlalchemy\\sql\\sqltypes.py\", line 2779, in process\n    return json_serializer(value)\n  File \"C:\\Program Files\\Python313\\Lib\\json\\__init__.py\", line 231, in dumps\n    return _default_encoder.encode(obj)\n           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^\n  File \"C:\\Program Files\\Python313\\Lib\\json\\encoder.py\", line 200, in encode\n    chunks = self.iterencode(o, _one_shot=True)\n  File \"C:\\Program Files\\Python313\\Lib\\json\\encoder.py\", line 261, in iterencode\n    return _iterencode(o, 0)\n  File \"C:\\Program Files\\Python313\\Lib\\json\\encoder.py\", line 180, in default\n    raise TypeError(f'Object of type {o.__class__.__name__} '\n                    f'is not JSON serializable')\nsqlalchemy.exc.StatementError: (builtins.TypeError) Object of type InlineKeyboardMarkup is not JSON serializable\n[SQL: INSERT INTO logs (timestamp, level, event_type, trace_id, message, payload, chat_id, user_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: [{'level': 'INFO', 'user_id': 377503014, 'payload': {'text': '/my_chats', 'username': 'rainey', 'chatname': 'rainey', 'update_type': 'message', 'markup ... (189 characters truncated) ... 2', 'message': 'Показан список чатов', 'event_type': 'my_chats', 'chat_id': 377503014, 'timestamp': datetime.datetime(2025, 11, 2, 20, 3, 45, 334571)}]]"}
